---
output: github_document
always_allow_html: yes
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

[![Travis-CI Build Status](https://travis-ci.org/yonicd/ripe.svg?branch=master)](https://travis-ci.org/yonicd/ripe)

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "README-"
)

library(ripe)
```

# ripe

The goal of ripe is to create a more flexible way to rerun {magrittr} pipes.

## Installation

```{r,eval=FALSE}
remotes::install_github('yonicd/ripe')
```


## WTAF

We want to write the following in a shorter and more flexible way

```{r,eval=FALSE}

f <- function(){
  
  stats::runif(20)%>%
    sample(10)%>%
    utils::head(5)
}

replicate(n=3,f(),simplify = FALSE)

```

This is better!

```{r,eval=FALSE}
stats::runif(20)%>%
  sample(10)%>%
  utils::head(5)%>%
  ripe(replicate,n=4,simplify=FALSE)
```

We can now manipulate the chain or move `ripe` around into different subsets of the chain, creating iterative replication workflows.

```{r,eval=FALSE}

stats::runif(20)%>%
  #sample(10)%>%
  utils::head(5)%>%
  ripe(replicate,n=4,simplify=FALSE)
  
```

## Examples

<details><summary> <code>replicate</code> </summary>

```{r example}
library(ripe)

stats::runif(20)%>%
  ripe(replicate,n=2,simplify=FALSE)

stats::runif(20)%>%
  sample(10)%>%
  ripe(replicate,n=3,simplify=FALSE)

stats::runif(20)%>%
  sample(10)%>%
  utils::head(5)%>%
  ripe(replicate,n=4,simplify=FALSE)

```

</details>
 
<details><summary> <code>apply</code> </summary>

```{r}
stats::runif(20)%>%
  sample(10)%>%
  utils::head(5)%>%
  ripe(lapply, X=1:4)
```

</details>
 
<details><summary> <code>mclapply</code> </summary>

```{r}
stats::runif(20)%>%
  sample(10)%>%
  utils::head(5)%>%
  ripe(
    parallel::mclapply,
    X=1:4,
    mc.cores = parallel::detectCores()-1)
```

</details>

<details><summary> <code>purrr</code> </summary>

```{r}
iris %>% 
  dplyr::sample_n(5) %>% 
  ripe(purrr::rerun,.n=3)

iris %>% 
  dplyr::select(1:2) %>% 
  dplyr::sample_n(20) %>% 
  ripe(purrr::rerun,.n=1)

iris %>% 
  dplyr::select(1:2)%>% 
  dplyr::sample_n(20) %>% 
  dplyr::slice(1:5) %>%
  ripe(purrr::rerun,.n=3)
```

</details>

## Convert Chain to Lazy

You can also quickly convert the chain to a lazyeval function

```{r}
f <- stats::runif(20)%>%
  sample(10)%>%
  utils::head(5)%>%
  lazy()

f()
f()
```